<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatMinute App</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ChatMinute</h1>
            <div class="user-info" id="userInfo">
                <span id="userName"></span>
                <button onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>
        </header>

        <main>
            <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
            <div id="loginScreen" class="screen">
                <div class="auth-form">
                    <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                    <div class="form-group">
                        <input type="text" id="loginUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                    </div>
                    <button onclick="login()" class="auth-btn">–í–æ–π—Ç–∏</button>
                    <div class="auth-switch">
                        –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a onclick="showRegisterScreen()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
                    </div>
                </div>
            </div>

            <!-- –≠–∫—Ä–∞–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
            <div id="registerScreen" class="screen hidden">
                <div class="auth-form">
                    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                    <div class="form-group">
                        <input type="text" id="registerUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                    </div>
                    <div class="form-group">
                        <input type="email" id="registerEmail" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="registerPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="registerConfirmPassword" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                    </div>
                    <div class="form-group">
                        <input type="text" id="registerFirstName" placeholder="–ò–º—è" required>
                    </div>
                    <div class="form-group">
                        <input type="text" id="registerLastName" placeholder="–§–∞–º–∏–ª–∏—è" required>
                    </div>
                    <div class="form-group">
                        <input type="number" id="registerAge" placeholder="–í–æ–∑—Ä–∞—Å—Ç" min="18" max="100" required>
                    </div>
                    <div class="form-group">
                        <select id="registerGender" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
                            <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                            <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                            <option value="other">–î—Ä—É–≥–æ–π</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <textarea id="registerBio" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</label>
                        <div class="location-inputs">
                            <input type="number" id="registerLat" step="any" placeholder="–®–∏—Ä–æ—Ç–∞" value="55.7558">
                            <input type="number" id="registerLng" step="any" placeholder="–î–æ–ª–≥–æ—Ç–∞" value="37.6173">
                        </div>
                        <small>–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–∫—É—â–µ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</small>
                        <button type="button" onclick="getCurrentLocation()" class="location-btn">
                            üìç –ü–æ–ª—É—á–∏—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
                        </button>
                    </div>
                    <button onclick="register()" class="auth-btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                    <div class="auth-switch">
                        –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a onclick="showLoginScreen()">–í–æ–π—Ç–∏</a>
                    </div>
                </div>
            </div>

            <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
            <div id="mainScreen" class="screen hidden">
                <div class="profile-section">
                    <h3>–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å</h3>
                    <div id="profileInfo"></div>
                </div>

                <div class="stats-section">
                    <h4>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                    <div id="statsInfo"></div>
                </div>

                <div class="controls">
                    <button id="startSearchBtn" onclick="startSearch()" class="search-btn">üîç –ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞</button>
                    <button id="stopSearchBtn" onclick="stopSearch()" class="stop-btn hidden">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∏—Å–∫</button>
                </div>

                <div id="status" class="status"></div>

                                    <!-- –í–∏–¥–µ–æ —á–∞—Ç -->
                    <!-- –í –±–ª–æ–∫–µ video-chat –¥–æ–±–∞–≤—å—Ç–µ/–æ–±–Ω–æ–≤–∏—Ç–µ: -->
                    <div id="videoChat" class="video-chat hidden">
                        <div class="video-container">
                            <!-- –ë–ª–æ–∫ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
                            <div id="debugInfo" style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.8); color: #00ff00; padding: 10px; border-radius: 5px; font-size: 12px; z-index: 1000; font-family: 'Courier New', monospace; border: 1px solid #00ff00;">
                                <div><strong>WebRTC Debug:</strong></div>
                                <div>Connection: <span id="connState">-</span></div>
                                <div>ICE: <span id="iceState">-</span></div>
                                <div>Signaling: <span id="sigState">-</span></div>
                                <div>Candidates: <span id="iceCandidates">0</span></div>
                                <div>TURN used: <span id="turnUsed" style="color: #f44336;">–Ω–µ—Ç</span></div>
                                <button onclick="window.testTURN && window.testTURN()" style="margin-top: 5px; background: #ff9800; color: black; border: none; padding: 5px; border-radius: 3px; font-size: 10px; width: 100%;">Test TURN</button>
                            </div>
                            
                            <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –≤–∏–¥–µ–æ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ -->
                            <div class="remote-video-wrapper">
                                <video id="remoteVideo" 
                                    autoplay 
                                    playsinline 
                                    webkit-playsinline
                                    style="width: 100%; height: 100%; object-fit: cover; background: #000; transform: scaleX(-1);">
                                </video>
                                <div class="video-label remote-video-label" id="partnerName">–°–æ–±–µ—Å–µ–¥–Ω–∏–∫</div>
                            </div>
                            
                            <!-- –ú–∞–ª–µ–Ω—å–∫–æ–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ -->
                            <div class="local-video-wrapper">
                                <video id="localVideo" 
                                    autoplay 
                                    muted 
                                    playsinline 
                                    webkit-playsinline
                                    style="width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1);">
                                </video>
                                <div class="video-label local-video-label">–í—ã</div>
                            </div>
                            
                            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–µ -->
                            <div class="partner-info">
                                <div class="partner-name" id="partnerFullName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                                <div class="partner-age" id="partnerAge"></div>
                            </div>
                            
                            <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–≤–µ—Ä—Ö –≤–∏–¥–µ–æ -->
                            <div class="chat-controls-overlay">
                                <div class="timer-section">
                                    <div class="timer" id="timer">01:00</div>
                                    <div class="timer-label" id="timerLabel">–¥–æ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è</div>
                                </div>
                                <div class="action-buttons">
                                    <button id="rejectBtn" onclick="rejectMatch()" class="reject" title="–ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è">üëé</button>
                                    <button id="approveBtn" onclick="approveMatch()" class="approve" title="–ù—Ä–∞–≤–∏—Ç—Å—è">üëç</button>
                                    <button id="endChatBtn" onclick="endConversation()" class="end-chat hidden" title="–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä">üìû</button>
                                </div>
                            </div>
                        </div>
                    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
    <div id="editProfileModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h3>
                <button onclick="hideEditProfileModal()" class="modal-close">√ó</button>
            </div>
            <div class="form-group">
                <input type="text" id="editFirstName" placeholder="–ò–º—è" required>
            </div>
            <div class="form-group">
                <input type="text" id="editLastName" placeholder="–§–∞–º–∏–ª–∏—è" required>
            </div>
            <div class="form-group">
                <input type="number" id="editAge" placeholder="–í–æ–∑—Ä–∞—Å—Ç" min="18" max="100" required>
            </div>
            <div class="form-group">
                <select id="editGender" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
                    <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                    <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                    <option value="other">–î—Ä—É–≥–æ–π</option>
                </select>
            </div>
            <div class="form-group">
                <textarea id="editBio" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ..." rows="3"></textarea>
            </div>
            <div class="form-group">
                <textarea id="editInterests" placeholder="–í–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã..." rows="2"></textarea>
            </div>
            <div class="form-group">
                <label>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</label>
                <div class="location-inputs">
                    <input type="number" id="editLat" step="any" placeholder="–®–∏—Ä–æ—Ç–∞" value="55.7558">
                    <input type="number" id="editLng" step="any" placeholder="–î–æ–ª–≥–æ—Ç–∞" value="37.6173">
                </div>
                <button type="button" onclick="getCurrentLocation()" class="location-btn">
                    üìç –ü–æ–ª—É—á–∏—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
                </button>
            </div>
            <div class="modal-actions">
                <button onclick="updateProfile()" class="save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button onclick="hideEditProfileModal()" class="cancel-btn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>